import{j as e,a3 as O,a4 as re,a5 as M,S as m,a6 as oe,T as E,h as C,k as v,r as l,c as z,a as D,a8 as q,B as I,a9 as L,aa as $,ab as K,ac as k,G as h,I as w,ad as T,p as G,af as Q,ag as X,b as J,ae as U,ah as se,M as Y,ai as le,n as Z,J as ie,K as ce,aj as de,Q as me,U as ue,W as pe,X as xe,Y as P,Z as N,$ as W,a0 as he,ak as ge,al as je,P as be,am as fe,N as Se,an as De,ao as we,ap as A,aq as V}from"./index-82d1cb39.js";import{D as Ce,P as ye,R as Fe,r as Te,I as H,a as ve}from"./index-7f621448.js";import{I as ee}from"./index-b4828643.js";import{L as te,A as ae,C as Re,E as Me}from"./CircularWithPath-7e64b0d1.js";import{C as Ie}from"./CSVExport-e38ab20f.js";import{S as ke,H as _e}from"./SelectColumnSorting-5588f9e8.js";import"./index-f2f65aee.js";const Ee=async i=>{try{await v.delete(`/inventory/sub-departments/${i}`)}catch(c){throw console.error("Erro ao deletar o polo:",c),c}};function Pe({id:i,title:c,open:a,handleClose:u,name:g}){const S=async()=>{try{await Ee(i),u(),window.location.reload()}catch{}};return e.jsx(O,{open:a,onClose:u,keepMounted:!0,TransitionComponent:re,maxWidth:"xs","aria-labelledby":"column-delete-title","aria-describedby":"column-delete-description",children:e.jsx(M,{sx:{mt:2,my:1},children:e.jsxs(m,{alignItems:"center",spacing:3.5,children:[e.jsx(oe,{color:"error",sx:{width:72,height:72,fontSize:"1.75rem"},children:e.jsx(Ce,{})}),e.jsxs(m,{spacing:2,children:[e.jsx(E,{variant:"h4",align:"center",children:"Você tem certeza?"}),e.jsxs(E,{align:"center",children:["Você está deletando o Subdepartamento",e.jsx(E,{variant:"subtitle1",component:"span",sx:{ml:.5},children:g}),", esta operação não pode ser desfeita."]})]}),e.jsxs(m,{direction:"row",spacing:2,sx:{width:1},children:[e.jsx(C,{fullWidth:!0,onClick:u,color:"secondary",variant:"outlined",children:"Cancelar"}),e.jsx(C,{fullWidth:!0,color:"error",variant:"contained",onClick:S,autoFocus:!0,children:"Deletar"})]})]})})})}function Ne({handleClose:i,modalEdit:c,data:a}){const[u,g]=l.useState(!0),[S,b]=l.useState([]),f=s=>({sub_departamento:(a==null?void 0:a.sub_departamento)||"",departamento:(a==null?void 0:a.departamentoId)||"",telefone:(a==null?void 0:a.telefone)||"",descricao:(a==null?void 0:a.descricao)||""}),j=z().shape({sub_departamento:D().max(255).required("Nome é obrigatório"),departamento:D().max(255).required("Nome do Departamento é obrigatório"),telefone:D().required("Telefone é obrigatório"),descricao:D().max(500)}),d=q({initialValues:f(),validationSchema:j,enableReinitialize:!0,onSubmit:async(s,{setSubmitting:F,resetForm:_})=>{try{(await v.put(`/inventory/sub-departments/${a.id}`,{sub_departamento:s.sub_departamento,telefone:s.telefone.replace(/\D/g,""),departamentoId:s.departamento,descricao:s.descricao})).data.success===!0&&(_(),i(!1))}catch(R){console.error(R)}}}),{errors:r,touched:n,handleSubmit:p,getFieldProps:t,setFieldValue:y}=d,o=async()=>{try{const s=await v.get("/inventory/departments/");b(s.data.departamentos.rows)}catch(s){console.error("Error fetching polos:",s)}finally{g(!1)}};return l.useEffect(()=>{o()},[]),e.jsx("div",{children:e.jsx(O,{open:c,keepMounted:!0,onClose:()=>i(!1),"aria-describedby":"alert-dialog-slide-description",children:e.jsx(I,{sx:{p:1,py:1.5},children:e.jsx(M,{children:e.jsx(L,{value:d,children:e.jsxs($,{autoComplete:"off",noValidate:!0,onSubmit:p,children:[e.jsxs(te,{dateAdapter:ae,children:[e.jsx(K,{children:"Editar Subdepartamento"}),e.jsx(k,{}),e.jsx(M,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"sub_departamento",children:"Nome SubDepartamento"}),e.jsx(T,{fullWidth:!0,id:"sub_departamento",placeholder:"Nome",...t("sub_departamento"),error:!!(n.sub_departamento&&r.sub_departamento),helperText:e.jsx(e.Fragment,{children:n.sub_departamento&&r.sub_departamento})})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"telefone",children:"Telefone"}),e.jsx(ee,{mask:"(99) 9999-9999",value:d.values.telefone,onChange:async s=>await y("telefone",s.target.value),children:s=>e.jsx(T,{fullWidth:!0,id:"telefone",placeholder:"Telefone",...s,error:!!(n.telefone&&r.telefone),helperText:n.telefone&&r.telefone})})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"departamento",children:"Departamento"}),e.jsxs(G,{fullWidth:!0,error:!!(n.departamento&&r.departamento),children:[e.jsx(Q,{id:"departamento",placeholder:"Nome",...t("departamento"),value:d.values.departamento,children:!u&&S.map(s=>e.jsx(X,{value:s.id,children:s.departamento},"dp_"+s.id))}),n.departamento&&r.departamento&&e.jsx(J,{children:typeof r.departamento})]})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"descricao",children:"Descrição"}),e.jsx(T,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...t("descricao"),error:!!(n.descricao&&r.descricao),helperText:e.jsx(e.Fragment,{children:n.descricao&&r.descricao})})]})})]})})})})]}),e.jsxs(U,{children:[e.jsx(C,{color:"error",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(C,{variant:"contained",type:"submit",children:"Cadastrar"})]})]})})})})})})}const Be=i=>({sub_departamento:"",departamento:"",telefone:"",descricao:""}),We=({subDepartament:i,closeModal:c})=>{l.useState([]);const[a,u]=l.useState(!0),[g,S]=l.useState([]),b=z().shape({departamento:D().max(255).required("Nome do Departamento é obrigatorio"),sub_departamento:D().max(255).required("Nome do SubDepartamento é obrigatorio"),telefone:D().test("minimo-8-digitos","O telefone deve ter no mínimo 8 números",o=>{const s=o==null?void 0:o.replace(/\D/g,"");return s&&s.length>=10}).required("Telefone é obrigatório"),descricao:D().max(500)}),f=async()=>{try{const o=await v.get("/inventory/departments/");S(o.data.departamentos.rows)}catch(o){console.error("Error fetching polos:",o)}finally{u(!1)}};l.useEffect(()=>{f()},[]);const j=q({initialValues:Be(),validationSchema:b,enableReinitialize:!0,onSubmit:async(o,{setSubmitting:s})=>{try{const F=await v.post("/inventory/sub-departments",{sub_departamento:o.sub_departamento,departamentoId:o.departamento,telefone:o.telefone.replace(/\D/g,""),descricao:o.descricao});s(!1),c()}catch(F){console.error(F)}}}),{errors:d,touched:r,handleSubmit:n,isSubmitting:p,getFieldProps:t,setFieldValue:y}=j;return e.jsx(L,{value:j,children:e.jsx(te,{dateAdapter:ae,children:e.jsxs($,{autoComplete:"off",noValidate:!0,onSubmit:n,children:[e.jsx(K,{children:"Novo Sub Departamento"}),e.jsx(k,{}),e.jsx(M,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"sub_departamento",children:"Nome do SubDepartamento"}),e.jsx(T,{fullWidth:!0,id:"sub_departamento",placeholder:"Nome",...t("sub_departamento"),error:!!(r.sub_departamento&&d.sub_departamento),helperText:e.jsx(e.Fragment,{children:r.sub_departamento&&d.sub_departamento})})]})}),e.jsx(h,{item:!0,xs:12,sm:3,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"telefone",children:"Telefone"}),e.jsx(ee,{mask:"(99)9999-9999",value:j.values.telefone,onChange:async o=>await y("telefone",o.target.value),children:o=>e.jsx(T,{fullWidth:!0,id:"telefone",placeholder:"Telefone",...o,error:!!(r.telefone&&d.telefone),helperText:r.telefone&&d.telefone})})]})}),e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"departamento",children:"Departamento"}),e.jsxs(G,{fullWidth:!0,error:!!(r.name&&d.name),children:[e.jsx(Q,{id:"departamento",placeholder:"Nome",...t("departamento"),value:j.values.departamento,children:g.map(o=>e.jsx(X,{value:o.id,children:o.departamento},"dp_"+o.id))}),r.departamento&&d.departamento&&e.jsx(J,{children:typeof d.departamento})]})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(m,{spacing:1,children:[e.jsx(w,{htmlFor:"descricao",children:"Descrição"}),e.jsx(T,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...t("descricao"),error:!!(r.descricao&&d.descricao),helperText:e.jsx(e.Fragment,{children:r.descricao&&d.descricao})})]})})]})})})}),e.jsx(k,{}),e.jsx(U,{sx:{p:2.5},children:e.jsx(h,{container:!0,justifyContent:"flex-end",alignItems:"center",children:e.jsx(h,{item:!0,children:e.jsxs(m,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(C,{color:"error",onClick:c,children:"Cancelar"}),e.jsx(C,{type:"submit",variant:"contained",disabled:p,children:"Cadastrar"})]})})})})]})})})},Ae=({openModalCreate:i,modalToggler:c,subdepartament:a})=>{const u=()=>{c(!1)},g=a?e.jsx(I,{sx:{p:5},children:e.jsx(m,{direction:"row",justifyContent:"center",children:e.jsx(Re,{})})}):e.jsx(We,{subDepartament:a??null,closeModal:u});return e.jsx(se,{open:i,onClose:u,"aria-labelledby":"modal-subdepartament-add-label","aria-describedby":"modal-subedepartament-add-description",sx:{"& .MuiPaper-root:focus":{outline:"none"}},children:e.jsx(Y,{sx:{width:"calc(100% - 48px)",minWidth:340,maxWidth:880,height:"auto",maxHeight:"calc(100vh - 48px)"},modal:!0,content:!1,children:e.jsx(le,{sx:{maxHeight:"calc(100vh - 48px)","& .simplebar-content":{display:"flex",flexDirection:"column"}},children:g})})})},Ve=(i,c,a,u)=>{const g=Te(i.getValue(c),a);return u(g),g.passed};function He({data:i,columns:c,modalToggler:a}){const u=Z(),g=ie(u.breakpoints.down("sm")),[S,b]=l.useState([{id:"id",desc:!0}]),[f,j]=l.useState({}),[d,r]=l.useState(""),n=ce({data:i,columns:c,state:{sorting:S,rowSelection:f,globalFilter:d},enableRowSelection:!0,onSortingChange:b,onRowSelectionChange:j,onGlobalFilterChange:r,getRowCanExpand:()=>!0,getSortedRowModel:be(),getFilteredRowModel:fe(),getCoreRowModel:Se(),getPaginationRowModel:De(),getExpandedRowModel:we(),globalFilterFn:Ve,debugTable:!0});return e.jsxs(Y,{content:!1,children:[e.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...g&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(de,{value:d??"",onFilterChange:p=>{r(String(p))},placeholder:`Buscar ${i.length} ...`}),e.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(ke,{getState:n.getState,getAllColumns:n.getAllColumns,setSorting:b}),e.jsxs(m,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(C,{variant:"contained",startIcon:e.jsx(ye,{}),onClick:a,children:"Adicionar Subdepartamento"}),e.jsx(Ie,{data:n.getSelectedRowModel().flatRows.map(p=>p.original).length===0?i:n.getSelectedRowModel().flatRows.map(p=>p.original),filename:"SubDepartament-list.csv"})]})]})]}),e.jsx(me,{children:e.jsxs(m,{children:[e.jsx(Fe,{selected:Object.keys(f).length}),e.jsx(ue,{children:e.jsxs(pe,{children:[e.jsx(xe,{children:n.getHeaderGroups().map(p=>e.jsx(P,{children:p.headers.map(t=>(t.column.columnDef.meta!==void 0&&t.column.getCanSort()&&Object.assign(t.column.columnDef.meta,{className:t.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(N,{...t.column.columnDef.meta,onClick:t.column.getToggleSortingHandler(),...t.column.getCanSort()&&t.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:t.isPlaceholder?null:e.jsxs(m,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(I,{children:W(t.column.columnDef.header,t.getContext())}),t.column.getCanSort()&&e.jsx(_e,{column:t.column})]})},t.id)))},p.id))}),e.jsx(he,{children:n.getRowModel().rows.length===0?e.jsx(P,{children:e.jsx(N,{colSpan:c.length,align:"center",children:e.jsx(ge,{msg:"Nenhum registro encontrado"})})}):n.getRowModel().rows.map(p=>e.jsx(l.Fragment,{children:e.jsx(P,{children:p.getVisibleCells().map(t=>e.jsx(N,{...t.column.columnDef.meta,children:W(t.column.columnDef.cell,t.getContext())},t.id))})},p.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(I,{sx:{p:2},children:e.jsx(je,{setPageSize:n.setPageSize,setPageIndex:n.setPageIndex,getState:n.getState,getPageCount:n.getPageCount})})]})]})})]})}function Qe(){const i=Z(),[c,a]=l.useState(!1),[u,g]=l.useState(!1),[S,b]=l.useState(!1),[f,j]=l.useState(!1),[d,r]=l.useState(null),[n,p]=l.useState(""),[t,y]=l.useState(""),[o,s]=l.useState([]);l.useState(!1);const F=async()=>{try{const x=await v.get("/inventory/sub-departments");s(x.data.sub_departamentos.rows)}catch(x){console.error("Erro ao buscar dados:",x)}};l.useEffect(()=>{F()},[f,u,n,p,t,y]);const _=()=>{a(!c)},R=()=>{j(!0)},B=()=>{g(!u)},ne=l.useMemo(()=>[{id:"select",header:({table:x})=>e.jsx(H,{checked:x.getIsAllRowsSelected(),indeterminate:x.getIsSomeRowsSelected(),onChange:x.getToggleAllRowsSelectedHandler()}),cell:({row:x})=>e.jsx(H,{checked:x.getIsSelected(),disabled:!x.getCanSelect(),indeterminate:x.getIsSomeSelected(),onChange:x.getToggleSelectedHandler()}),meta:{className:"p-0"}},{accessorKey:"sub_departamento",header:"Sub departamento"},{accessorKey:"telefone",header:"Telefone"},{accessorKey:"departamentos.departamento",header:"Departamento"},{accessorKey:"descricao",header:"Descrição"},{id:"actions",header:"Açôes",cell:({row:x})=>e.jsxs(m,{direction:"row",spacing:1,children:[e.jsx(A,{title:"Editar",children:e.jsx(V,{color:"primary",onClick:()=>{r(x.original),R()},children:e.jsx(Me,{})})}),e.jsx(A,{title:"Excluir",children:e.jsx(V,{color:"error",onClick:()=>{p(x.original.id),a(!0),y(x.original.sub_departamento)},children:e.jsx(ve,{})})})]})}],[i]);return e.jsxs(e.Fragment,{children:[e.jsx(He,{data:o,columns:ne,modalToggler:()=>{b(!0),r(null),B()}}),e.jsx(Pe,{id:n,title:n,open:c,handleClose:_,name:t}),e.jsx(Ae,{openModalCreate:u,modalToggler:B}),e.jsx(Ne,{modalEdit:f,handleClose:j,data:d})]})}export{Qe as default};
