import{j as e,a3 as H,a4 as oe,a5 as f,S as u,a6 as re,T,i as S,l as F,c as z,a as b,a8 as O,a9 as $,aa as G,ab as L,ac as w,G as h,I as D,ad as R,ae as q,r as d,ah as se,M as K,ai as ne,B as M,o as Q,J as ie,K as ce,at as le,aj as de,Q as ge,U as ue,W as xe,X as me,Y as I,Z as k,$ as N,a0 as he,ak as je,al as pe,P as Ce,am as Se,N as ye,an as fe,ao as be,ap as A,aq as V}from"./index-4a286e5b.js";import{D as we,P as De,R as Re,r as Me,I as W,a as Fe}from"./index-12584614.js";import{L as X,A as J,C as ve,E as Te}from"./CircularWithPath-2be210af.js";import{S as Ie,H as ke}from"./SelectColumnSorting-8f7c879d.js";function Pe({id:s,title:n,open:a,handleClose:o,name:r}){const p=async x=>{try{await F.delete(`/inventory/categories/${x}`)}catch(m){throw console.error("Erro ao deletar a categoria:",m),m}},g=async()=>{try{await p(s),o(),window.location.reload()}catch{}};return e.jsx(H,{open:a,onClose:o,keepMounted:!0,TransitionComponent:oe,maxWidth:"xs","aria-labelledby":"column-delete-title","aria-describedby":"column-delete-description",children:e.jsx(f,{sx:{mt:2,my:1},children:e.jsxs(u,{alignItems:"center",spacing:3.5,children:[e.jsx(re,{color:"error",sx:{width:72,height:72,fontSize:"1.75rem"},children:e.jsx(we,{})}),e.jsxs(u,{spacing:2,children:[e.jsx(T,{variant:"h4",align:"center",children:"Você tem certeza?"}),e.jsxs(T,{align:"center",children:["Você está deletando a categoria",e.jsx(T,{variant:"subtitle1",component:"span",sx:{ml:.5},children:r}),", esta operação não pode ser desfeita."]})]}),e.jsxs(u,{direction:"row",spacing:2,sx:{width:1},children:[e.jsx(S,{fullWidth:!0,onClick:o,color:"secondary",variant:"outlined",children:"Cancelar"}),e.jsx(S,{fullWidth:!0,color:"error",variant:"contained",onClick:g,autoFocus:!0,children:"Deletar"})]})]})})})}const Ee=s=>({categoria:"",descricao:""}),B=({category:s,closeModal:n})=>{const a=z().shape({categoria:b().max(255).required("Nome é obrigatorio"),descricao:b().max(500)}),o=O({initialValues:Ee(),validationSchema:a,enableReinitialize:!0,onSubmit:async(j,{setSubmitting:i})=>{try{const c=await F.post("/inventory/categories",{categoria:j.categoria,descricao:j.descricao});i(!1),n()}catch(c){console.error(c)}}}),{errors:r,touched:p,handleSubmit:g,isSubmitting:x,getFieldProps:m,setFieldValue:C}=o;return e.jsx($,{value:o,children:e.jsx(X,{dateAdapter:J,children:e.jsxs(G,{autoComplete:"off",noValidate:!0,onSubmit:g,children:[e.jsx(L,{children:"Nova Categoria"}),e.jsx(w,{}),e.jsx(f,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(u,{spacing:1,children:[e.jsx(D,{htmlFor:"categoria",children:"Nome da categoria"}),e.jsx(R,{fullWidth:!0,id:"categoria",placeholder:"Nome",...m("categoria"),error:!!(p.categoria&&r.categoria),helperText:typeof r.sala=="string"?r.sala:null})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(u,{spacing:1,children:[e.jsx(D,{htmlFor:"descricao",children:"Descrição"}),e.jsx(R,{fullWidth:!0,id:"descricao",minRows:2,placeholder:"Descrição",...m("descricao"),error:!!(p.descricao&&r.descricao),helperText:typeof r.descricao=="string"?r.descricao:null})]})})]})})})}),e.jsx(w,{}),e.jsx(q,{sx:{p:2.5},children:e.jsx(h,{container:!0,justifyContent:"flex-end",alignItems:"center",children:e.jsx(h,{item:!0,children:e.jsxs(u,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(S,{color:"error",onClick:n,children:"Cancelar"}),e.jsx(S,{type:"submit",variant:"contained",disabled:x,children:"Cadastrar"})]})})})})]})})})},Ne=({openModalCreate:s,modalToggler:n,category:a})=>{const o=()=>{n(!1)};d.useMemo(()=>!a&&e.jsx(B,{category:a??null,closeModal:o}),[a]);const r=a?e.jsx(M,{sx:{p:5},children:e.jsx(u,{direction:"row",justifyContent:"center",children:e.jsx(ve,{})})}):e.jsx(B,{category:a??null,closeModal:o});return e.jsx(se,{open:s,onClose:o,"aria-labelledby":"modal-category-add-label","aria-describedby":"modal-category-add-description",sx:{"& .MuiPaper-root:focus":{outline:"none"}},children:e.jsx(K,{sx:{width:"calc(100% - 48px)",minWidth:340,maxWidth:880,height:"auto",maxHeight:"calc(100vh - 48px)"},modal:!0,content:!1,children:e.jsx(ne,{sx:{maxHeight:"calc(100vh - 48px)","& .simplebar-content":{display:"flex",flexDirection:"column"}},children:r})})})};function Ae({handleClose:s,modalEdit:n,data:a}){const o=c=>({categoria:(a==null?void 0:a.categoria)??"",descricao:(a==null?void 0:a.descricao)??""}),r=z().shape({categoria:b().max(255).required("Nome é obrigatorio"),descricao:b().max(500)}),p=O({initialValues:o(),validationSchema:r,enableReinitialize:!0,onSubmit:async(c,{setSubmitting:t,resetForm:v})=>{try{const y=await F.put(`/inventory/categories/${a.id}`,{categoria:c.categoria,descricao:c.descricao});v(),t(!1),s(!1)}catch(y){console.error(y)}}}),{errors:g,touched:x,handleSubmit:m,isSubmitting:C,getFieldProps:j,setFieldValue:i}=p;return e.jsx("div",{children:e.jsx(H,{open:n,keepMounted:!0,onClose:()=>{s(!1)},"aria-describedby":"alert-dialog-slide-description",children:e.jsx(M,{sx:{p:1,py:1.5},children:e.jsx(f,{children:e.jsx($,{value:p,children:e.jsxs(G,{autoComplete:"off",noValidate:!0,onSubmit:m,children:[e.jsxs(X,{dateAdapter:J,children:[e.jsx(L,{children:"Editar Categoria"}),e.jsx(w,{}),e.jsx(f,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(u,{spacing:1,children:[e.jsx(D,{htmlFor:"categoria",children:"Nome Categoria"}),e.jsx(R,{fullWidth:!0,id:"categoria",placeholder:"Nome",...j("categoria"),error:!!(x.categoria&&g.categoria),helperText:typeof g.categoria=="string"?g.categoria:null})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(u,{spacing:1,children:[e.jsx(D,{htmlFor:"descricao",children:"Descrição"}),e.jsx(R,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...j("descricao"),error:!!(x.descricao&&g.descricao),helperText:typeof g.descricao=="string"?g.descricao:null})]})})]})})})})]}),e.jsxs(q,{children:[e.jsx(S,{color:"error",onClick:()=>{s(!1)},children:"Cancelar"}),e.jsx(S,{variant:"contained",type:"submit",children:"Cadastrar"})]})]})})})})})})}const Ve=(s,n,a,o)=>{const r=Me(s.getValue(n),a);return o(r),r.passed};function We({data:s,columns:n,modalToggler:a}){const o=Q(),r=ie(o.breakpoints.down("sm")),[p,g]=d.useState([{id:"id",desc:!0}]),[x,m]=d.useState({}),[C,j]=d.useState(""),i=ce({data:s,columns:n,state:{sorting:p,rowSelection:x,globalFilter:C},enableRowSelection:!0,onSortingChange:g,onRowSelectionChange:m,onGlobalFilterChange:j,getRowCanExpand:()=>!0,getSortedRowModel:Ce(),getFilteredRowModel:Se(),getCoreRowModel:ye(),getPaginationRowModel:fe(),getExpandedRowModel:be(),globalFilterFn:Ve});return le(o.palette.primary.lighter,.1),e.jsxs(K,{content:!1,children:[e.jsxs(u,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...r&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(de,{value:C??"",onFilterChange:c=>{j(String(c))},placeholder:`Search ${s.length} records...`}),e.jsxs(u,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(Ie,{getState:i.getState,getAllColumns:i.getAllColumns,setSorting:g}),e.jsx(u,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(S,{variant:"contained",startIcon:e.jsx(De,{}),onClick:a,children:"Adicionar Categoria"})})]})]}),e.jsx(ge,{children:e.jsxs(u,{children:[e.jsx(Re,{selected:Object.keys(x).length}),e.jsx(ue,{children:e.jsxs(xe,{children:[e.jsx(me,{children:i.getHeaderGroups().map(c=>e.jsx(I,{children:c.headers.map(t=>(t.column.columnDef.meta!==void 0&&t.column.getCanSort()&&Object.assign(t.column.columnDef.meta,{className:t.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(k,{...t.column.columnDef.meta,onClick:t.column.getToggleSortingHandler(),...t.column.getCanSort()&&t.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:t.isPlaceholder?null:e.jsxs(u,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(M,{children:N(t.column.columnDef.header,t.getContext())}),t.column.getCanSort()&&e.jsx(ke,{column:t.column})]})},t.id)))},c.id))}),e.jsx(he,{children:i.getRowModel().rows.length===0?e.jsx(I,{children:e.jsx(k,{colSpan:n.length,align:"center",children:e.jsx(je,{msg:"Nenhum registro encontrado"})})}):i.getRowModel().rows.map(c=>e.jsx(d.Fragment,{children:e.jsx(I,{children:c.getVisibleCells().map(t=>e.jsx(k,{...t.column.columnDef.meta,children:N(t.column.columnDef.cell,t.getContext())},t.id))})},c.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsx(M,{sx:{p:2},children:e.jsx(pe,{setPageSize:i.setPageSize,setPageIndex:i.setPageIndex,getState:i.getState,getPageCount:i.getPageCount})})]})]})})]})}function $e(){const s=Q(),[n,a]=d.useState(!1),[o,r]=d.useState(!1),[p,g]=d.useState(!1),[x,m]=d.useState(!1),[C,j]=d.useState(null),[i,c]=d.useState(""),[t,v]=d.useState(""),[y,U]=d.useState(!1),[Y,Z]=d.useState([]),_=async()=>{try{const l=await F.get("/inventory/categories");Z(l.data.categorias.rows)}catch(l){console.error("Erro ao buscar dados:",l)}};d.useEffect(()=>{_()},[x,i,t,o,C,y,U]);const ee=()=>{a(!n)},te=()=>{m(!0)},P=()=>{r(!o)},ae=d.useMemo(()=>[{id:"select",header:({table:l})=>e.jsx(W,{checked:l.getIsAllRowsSelected(),indeterminate:l.getIsSomeRowsSelected(),onChange:l.getToggleAllRowsSelectedHandler()}),cell:({row:l})=>e.jsx(W,{checked:l.getIsSelected(),disabled:!l.getCanSelect(),indeterminate:l.getIsSomeSelected(),onChange:l.getToggleSelectedHandler()}),meta:{className:"p-0"}},{accessorKey:"categoria",header:"Nome"},{accessorKey:"descricao",header:"Descrição"},{id:"actions",header:"Actions",cell:({row:l})=>e.jsxs(u,{direction:"row",spacing:1,children:[e.jsx(A,{title:"Editar",children:e.jsx(V,{color:"primary",onClick:()=>{j(l.original),te()},children:e.jsx(Te,{})})}),e.jsx(A,{title:"Excluir",children:e.jsx(V,{color:"error",onClick:()=>{var E;v((E=l.original)==null?void 0:E.categoria),c(l.original.id),a(!0)},children:e.jsx(Fe,{})})})]})}],[s]);return e.jsxs(e.Fragment,{children:[e.jsx(We,{data:Y,columns:ae,modalToggler:()=>{g(!0),j(null),P()}}),e.jsx(Pe,{id:i,title:i,open:n,handleClose:ee,name:t}),e.jsx(Ne,{openModalCreate:o,modalToggler:P}),e.jsx(Ae,{modalEdit:x,handleClose:m,data:C})]})}export{$e as default};
