import{j as e,a3 as O,a4 as se,a5 as _,S as d,a6 as le,T as k,h as w,k as v,r as l,c as z,a as D,a8 as L,B as I,a9 as q,aa as K,ab as $,ac as P,G as h,I as C,ad as T,p as G,af as Q,ag as X,b as J,ae as U,ah as ie,M as Y,ai as ce,n as Z,J as de,K as me,aj as ue,Q as pe,U as xe,W as he,X as ge,Y as E,Z as N,$ as W,a0 as je,ak as be,al as fe,P as Se,am as De,N as Ce,an as we,ao as ye,ap as A,aq as V}from"./index-59fc1978.js";import{D as Fe,P as Te,R as ve,r as Re,I as H,a as Ie}from"./index-26f02c47.js";import{I as ee}from"./index-a611d58f.js";import{L as te,A as ae,C as Me,E as ke,a as _e}from"./CircularWithPath-8c799476.js";import{C as Pe}from"./CSVExport-7c808a43.js";import{S as Ee,H as Ne}from"./SelectColumnSorting-f02271ea.js";import"./index-c0288a9a.js";const Be=async m=>{try{await v.delete(`/inventory/sub-departments/${m}`)}catch(i){throw console.error("Erro ao deletar o polo:",i),i}};function We({id:m,title:i,open:a,handleClose:u,name:g}){const S=async()=>{try{await Be(m),u(),window.location.reload()}catch{}};return e.jsx(O,{open:a,onClose:u,keepMounted:!0,TransitionComponent:se,maxWidth:"xs","aria-labelledby":"column-delete-title","aria-describedby":"column-delete-description",children:e.jsx(_,{sx:{mt:2,my:1},children:e.jsxs(d,{alignItems:"center",spacing:3.5,children:[e.jsx(le,{color:"error",sx:{width:72,height:72,fontSize:"1.75rem"},children:e.jsx(Fe,{})}),e.jsxs(d,{spacing:2,children:[e.jsx(k,{variant:"h4",align:"center",children:"Você tem certeza?"}),e.jsxs(k,{align:"center",children:["Você está deletando o Subdepartamento",e.jsx(k,{variant:"subtitle1",component:"span",sx:{ml:.5},children:g}),", esta operação não pode ser desfeita."]})]}),e.jsxs(d,{direction:"row",spacing:2,sx:{width:1},children:[e.jsx(w,{fullWidth:!0,onClick:u,color:"secondary",variant:"outlined",children:"Cancelar"}),e.jsx(w,{fullWidth:!0,color:"error",variant:"contained",onClick:S,autoFocus:!0,children:"Deletar"})]})]})})})}function Ae({handleClose:m,modalEdit:i,data:a}){const[u,g]=l.useState(!0),[S,b]=l.useState([]),f=s=>({sub_departamento:(a==null?void 0:a.sub_departamento)||"",departamento:(a==null?void 0:a.departamentoId)||"",telefone:(a==null?void 0:a.telefone)||"",descricao:(a==null?void 0:a.descricao)||""}),j=z().shape({sub_departamento:D().max(255).required("Nome é obrigatório"),departamento:D().max(255).required("Nome do Departamento é obrigatório"),telefone:D().required("Telefone é obrigatório"),descricao:D().max(500)}),c=L({initialValues:f(),validationSchema:j,enableReinitialize:!0,onSubmit:async(s,{setSubmitting:F,resetForm:R})=>{try{(await v.put(`/inventory/sub-departments/${a.id}`,{sub_departamento:s.sub_departamento,telefone:s.telefone.replace(/\D/g,""),departamentoId:s.departamento,descricao:s.descricao})).data.success===!0&&(R(),m(!1))}catch(M){console.error(M)}}}),{errors:r,touched:n,handleSubmit:p,getFieldProps:t,setFieldValue:y}=c,o=async()=>{try{const s=await v.get("/inventory/departments/");b(s.data.departamentos.rows)}catch(s){console.error("Error fetching polos:",s)}finally{g(!1)}};return l.useEffect(()=>{o()},[]),e.jsx("div",{children:e.jsx(O,{open:i,keepMounted:!0,onClose:()=>m(!1),"aria-describedby":"alert-dialog-slide-description",children:e.jsx(I,{sx:{p:1,py:1.5},children:e.jsx(_,{children:e.jsx(q,{value:c,children:e.jsxs(K,{autoComplete:"off",noValidate:!0,onSubmit:p,children:[e.jsxs(te,{dateAdapter:ae,children:[e.jsx($,{children:"Editar Subdepartamento"}),e.jsx(P,{}),e.jsx(_,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"sub_departamento",children:"Nome SubDepartamento"}),e.jsx(T,{fullWidth:!0,id:"sub_departamento",placeholder:"Nome",...t("sub_departamento"),error:!!(n.sub_departamento&&r.sub_departamento),helperText:e.jsx(e.Fragment,{children:n.sub_departamento&&r.sub_departamento})})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"telefone",children:"Telefone"}),e.jsx(ee,{mask:"(99) 9999-9999",value:c.values.telefone,onChange:async s=>await y("telefone",s.target.value),children:s=>e.jsx(T,{fullWidth:!0,id:"telefone",placeholder:"Telefone",...s,error:!!(n.telefone&&r.telefone),helperText:n.telefone&&r.telefone})})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"departamento",children:"Departamento"}),e.jsxs(G,{fullWidth:!0,error:!!(n.departamento&&r.departamento),children:[e.jsx(Q,{id:"departamento",placeholder:"Nome",...t("departamento"),value:c.values.departamento,children:!u&&S.map(s=>e.jsx(X,{value:s.id,children:s.departamento},"dp_"+s.id))}),n.departamento&&r.departamento&&e.jsx(J,{children:typeof r.departamento})]})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"descricao",children:"Descrição"}),e.jsx(T,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...t("descricao"),error:!!(n.descricao&&r.descricao),helperText:e.jsx(e.Fragment,{children:n.descricao&&r.descricao})})]})})]})})})})]}),e.jsxs(U,{children:[e.jsx(w,{color:"error",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(w,{variant:"contained",type:"submit",children:"Cadastrar"})]})]})})})})})})}const Ve=m=>({sub_departamento:"",departamento:"",telefone:"",descricao:""}),He=({subDepartament:m,closeModal:i})=>{l.useState([]);const[a,u]=l.useState(!0),[g,S]=l.useState([]),b=z().shape({departamento:D().max(255).required("Nome do Departamento é obrigatorio"),sub_departamento:D().max(255).required("Nome do SubDepartamento é obrigatorio"),telefone:D().test("minimo-8-digitos","O telefone deve ter no mínimo 8 números",o=>{const s=o==null?void 0:o.replace(/\D/g,"");return s&&s.length>=10}).required("Telefone é obrigatório"),descricao:D().max(500)}),f=async()=>{try{const o=await v.get("/inventory/departments/");S(o.data.departamentos.rows)}catch(o){console.error("Error fetching polos:",o)}finally{u(!1)}};l.useEffect(()=>{f()},[]);const j=L({initialValues:Ve(),validationSchema:b,enableReinitialize:!0,onSubmit:async(o,{setSubmitting:s})=>{try{const F=await v.post("/inventory/sub-departments",{sub_departamento:o.sub_departamento,departamentoId:o.departamento,telefone:o.telefone.replace(/\D/g,""),descricao:o.descricao});s(!1),i()}catch(F){console.error(F)}}}),{errors:c,touched:r,handleSubmit:n,isSubmitting:p,getFieldProps:t,setFieldValue:y}=j;return e.jsx(q,{value:j,children:e.jsx(te,{dateAdapter:ae,children:e.jsxs(K,{autoComplete:"off",noValidate:!0,onSubmit:n,children:[e.jsx($,{children:"Novo Sub Departamento"}),e.jsx(P,{}),e.jsx(_,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"sub_departamento",children:"Nome do SubDepartamento"}),e.jsx(T,{fullWidth:!0,id:"sub_departamento",placeholder:"Nome",...t("sub_departamento"),error:!!(r.sub_departamento&&c.sub_departamento),helperText:e.jsx(e.Fragment,{children:r.sub_departamento&&c.sub_departamento})})]})}),e.jsx(h,{item:!0,xs:12,sm:3,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"telefone",children:"Telefone"}),e.jsx(ee,{mask:"(99)9999-9999",value:j.values.telefone,onChange:async o=>await y("telefone",o.target.value),children:o=>e.jsx(T,{fullWidth:!0,id:"telefone",placeholder:"Telefone",...o,error:!!(r.telefone&&c.telefone),helperText:r.telefone&&c.telefone})})]})}),e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"departamento",children:"Departamento"}),e.jsxs(G,{fullWidth:!0,error:!!(r.name&&c.name),children:[e.jsx(Q,{id:"departamento",placeholder:"Nome",...t("departamento"),value:j.values.departamento,children:g.map(o=>e.jsx(X,{value:o.id,children:o.departamento},"dp_"+o.id))}),r.departamento&&c.departamento&&e.jsx(J,{children:typeof c.departamento})]})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(d,{spacing:1,children:[e.jsx(C,{htmlFor:"descricao",children:"Descrição"}),e.jsx(T,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...t("descricao"),error:!!(r.descricao&&c.descricao),helperText:e.jsx(e.Fragment,{children:r.descricao&&c.descricao})})]})})]})})})}),e.jsx(P,{}),e.jsx(U,{sx:{p:2.5},children:e.jsx(h,{container:!0,justifyContent:"flex-end",alignItems:"center",children:e.jsx(h,{item:!0,children:e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(w,{color:"error",onClick:i,children:"Cancelar"}),e.jsx(w,{type:"submit",variant:"contained",disabled:p,children:"Cadastrar"})]})})})})]})})})},Oe=({openModalCreate:m,modalToggler:i,subdepartament:a})=>{const u=()=>{i(!1)},g=a?e.jsx(I,{sx:{p:5},children:e.jsx(d,{direction:"row",justifyContent:"center",children:e.jsx(Me,{})})}):e.jsx(He,{subDepartament:a??null,closeModal:u});return e.jsx(ie,{open:m,onClose:u,"aria-labelledby":"modal-subdepartament-add-label","aria-describedby":"modal-subedepartament-add-description",sx:{"& .MuiPaper-root:focus":{outline:"none"}},children:e.jsx(Y,{sx:{width:"calc(100% - 48px)",minWidth:340,maxWidth:880,height:"auto",maxHeight:"calc(100vh - 48px)"},modal:!0,content:!1,children:e.jsx(ce,{sx:{maxHeight:"calc(100vh - 48px)","& .simplebar-content":{display:"flex",flexDirection:"column"}},children:g})})})},ze=(m,i,a,u)=>{const g=Re(m.getValue(i),a);return u(g),g.passed};function Le({data:m,columns:i,modalToggler:a}){const u=Z(),g=de(u.breakpoints.down("sm")),[S,b]=l.useState([{id:"id",desc:!0}]),[f,j]=l.useState({}),[c,r]=l.useState(""),n=me({data:m,columns:i,state:{sorting:S,rowSelection:f,globalFilter:c},enableRowSelection:!0,onSortingChange:b,onRowSelectionChange:j,onGlobalFilterChange:r,getRowCanExpand:()=>!0,getSortedRowModel:Se(),getFilteredRowModel:De(),getCoreRowModel:Ce(),getPaginationRowModel:we(),getExpandedRowModel:ye(),globalFilterFn:ze,debugTable:!0});return e.jsxs(Y,{content:!1,children:[e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...g&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ue,{value:c??"",onFilterChange:p=>{r(String(p))},placeholder:"Buscar Subdepartamento ..."}),e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(Ee,{getState:n.getState,getAllColumns:n.getAllColumns,setSorting:b}),e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(w,{variant:"contained",startIcon:e.jsx(Te,{}),onClick:a,children:"Adicionar Subdepartamento"}),e.jsx(Pe,{data:n.getSelectedRowModel().flatRows.map(p=>p.original).length===0?m:n.getSelectedRowModel().flatRows.map(p=>p.original),filename:"SubDepartament-list.csv"})]})]})]}),e.jsx(pe,{children:e.jsxs(d,{children:[e.jsx(ve,{selected:Object.keys(f).length}),e.jsx(xe,{children:e.jsxs(he,{children:[e.jsx(ge,{children:n.getHeaderGroups().map(p=>e.jsx(E,{children:p.headers.map(t=>(t.column.columnDef.meta!==void 0&&t.column.getCanSort()&&Object.assign(t.column.columnDef.meta,{className:t.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(N,{...t.column.columnDef.meta,onClick:t.column.getToggleSortingHandler(),...t.column.getCanSort()&&t.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:t.isPlaceholder?null:e.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(I,{children:W(t.column.columnDef.header,t.getContext())}),t.column.getCanSort()&&e.jsx(Ne,{column:t.column})]})},t.id)))},p.id))}),e.jsx(je,{children:n.getRowModel().rows.length===0?e.jsx(E,{children:e.jsx(N,{colSpan:i.length,align:"center",children:e.jsx(be,{msg:"Nenhum registro encontrado"})})}):n.getRowModel().rows.map(p=>e.jsx(l.Fragment,{children:e.jsx(E,{children:p.getVisibleCells().map(t=>e.jsx(N,{...t.column.columnDef.meta,children:W(t.column.columnDef.cell,t.getContext())},t.id))})},p.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsx(I,{sx:{p:2},children:e.jsx(fe,{setPageSize:n.setPageSize,setPageIndex:n.setPageIndex,getState:n.getState,getPageCount:n.getPageCount})})]})]})})]})}function Ue(){const m=Z(),[i,a]=l.useState(!1),[u,g]=l.useState(!1),[S,b]=l.useState(!1),[f,j]=l.useState(!1),[c,r]=l.useState(null),[n,p]=l.useState(""),[t,y]=l.useState(""),[o,s]=l.useState([]);l.useState(!1);const[F,R]=l.useState(!1),M=async()=>{try{R(!0);const x=await v.get("/inventory/sub-departments");s(x.data.sub_departamentos.rows),R(!1)}catch(x){console.error("Erro ao buscar dados:",x),R(!1)}};l.useEffect(()=>{M()},[f,u,n,p,t,y]);const ne=()=>{a(!i)},re=()=>{j(!0)},B=()=>{g(!u)},oe=l.useMemo(()=>[{id:"select",header:({table:x})=>e.jsx(H,{checked:x.getIsAllRowsSelected(),indeterminate:x.getIsSomeRowsSelected(),onChange:x.getToggleAllRowsSelectedHandler()}),cell:({row:x})=>e.jsx(H,{checked:x.getIsSelected(),disabled:!x.getCanSelect(),indeterminate:x.getIsSomeSelected(),onChange:x.getToggleSelectedHandler()}),meta:{className:"p-0"}},{accessorKey:"sub_departamento",header:"Subdepartamento"},{accessorKey:"telefone",header:"Telefone"},{accessorKey:"departamentos.departamento",header:"Departamento"},{accessorKey:"descricao",header:"Descrição"},{id:"actions",header:"Açôes",cell:({row:x})=>e.jsxs(d,{direction:"row",spacing:1,children:[e.jsx(A,{title:"Editar",children:e.jsx(V,{color:"primary",onClick:()=>{r(x.original),re()},children:e.jsx(ke,{})})}),e.jsx(A,{title:"Excluir",children:e.jsx(V,{color:"error",onClick:()=>{p(x.original.id),a(!0),y(x.original.sub_departamento)},children:e.jsx(Ie,{})})})]})}],[m]);return e.jsxs(e.Fragment,{children:[F?e.jsxs(I,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",children:[e.jsx(_e,{}),e.jsx(k,{variant:"body2",color:"textSecondary",sx:{mt:2},children:"Carregando..."})]}):e.jsx(Le,{data:o,columns:oe,modalToggler:()=>{b(!0),r(null),B()}}),e.jsx(We,{id:n,title:n,open:i,handleClose:ne,name:t}),e.jsx(Oe,{openModalCreate:u,modalToggler:B}),e.jsx(Ae,{modalEdit:f,handleClose:j,data:c})]})}export{Ue as default};
