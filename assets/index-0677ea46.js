import{j as e,a3 as z,a4 as se,a5 as w,S as u,a6 as ne,T as b,h as y,k as F,c as O,a as D,a8 as L,a9 as $,aa as G,ab as q,ac as R,G as h,I as M,ad as v,ae as K,r as s,ah as ie,M as Q,ai as ce,B as S,n as X,J as le,K as de,at as ge,aj as ue,Q as xe,U as me,W as he,X as je,Y as k,Z as P,$ as A,a0 as pe,ak as Ce,al as ye,P as Se,am as fe,N as be,an as we,ao as De,ap as V,aq as B}from"./index-59fc1978.js";import{D as Re,P as Me,R as ve,r as Fe,I as W,a as Ie}from"./index-26f02c47.js";import{L as J,A as U,C as Te,E as ke,a as Pe}from"./CircularWithPath-8c799476.js";import{S as Ee,H as Ne}from"./SelectColumnSorting-f02271ea.js";function Ae({id:d,title:n,open:a,handleClose:o,name:r}){const p=async x=>{try{await F.delete(`/inventory/categories/${x}`)}catch(m){throw console.error("Erro ao deletar a categoria:",m),m}},g=async()=>{try{await p(d),o(),window.location.reload()}catch{}};return e.jsx(z,{open:a,onClose:o,keepMounted:!0,TransitionComponent:se,maxWidth:"xs","aria-labelledby":"column-delete-title","aria-describedby":"column-delete-description",children:e.jsx(w,{sx:{mt:2,my:1},children:e.jsxs(u,{alignItems:"center",spacing:3.5,children:[e.jsx(ne,{color:"error",sx:{width:72,height:72,fontSize:"1.75rem"},children:e.jsx(Re,{})}),e.jsxs(u,{spacing:2,children:[e.jsx(b,{variant:"h4",align:"center",children:"Você tem certeza?"}),e.jsxs(b,{align:"center",children:["Você está deletando a categoria",e.jsx(b,{variant:"subtitle1",component:"span",sx:{ml:.5},children:r}),", esta operação não pode ser desfeita."]})]}),e.jsxs(u,{direction:"row",spacing:2,sx:{width:1},children:[e.jsx(y,{fullWidth:!0,onClick:o,color:"secondary",variant:"outlined",children:"Cancelar"}),e.jsx(y,{fullWidth:!0,color:"error",variant:"contained",onClick:g,autoFocus:!0,children:"Deletar"})]})]})})})}const Ve=d=>({categoria:"",descricao:""}),H=({category:d,closeModal:n})=>{const a=O().shape({categoria:D().max(255).required("Nome é obrigatorio"),descricao:D().max(500)}),o=L({initialValues:Ve(),validationSchema:a,enableReinitialize:!0,onSubmit:async(j,{setSubmitting:i})=>{try{const c=await F.post("/inventory/categories",{categoria:j.categoria,descricao:j.descricao});i(!1),n()}catch(c){console.error(c)}}}),{errors:r,touched:p,handleSubmit:g,isSubmitting:x,getFieldProps:m,setFieldValue:C}=o;return e.jsx($,{value:o,children:e.jsx(J,{dateAdapter:U,children:e.jsxs(G,{autoComplete:"off",noValidate:!0,onSubmit:g,children:[e.jsx(q,{children:"Nova Categoria"}),e.jsx(R,{}),e.jsx(w,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsxs(u,{spacing:1,children:[e.jsx(M,{htmlFor:"categoria",children:"Nome da categoria"}),e.jsx(v,{fullWidth:!0,id:"categoria",placeholder:"Nome",...m("categoria"),error:!!(p.categoria&&r.categoria),helperText:typeof r.sala=="string"?r.sala:null})]})}),e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(u,{spacing:1,children:[e.jsx(M,{htmlFor:"descricao",children:"Descrição"}),e.jsx(v,{fullWidth:!0,id:"descricao",minRows:2,placeholder:"Descrição",...m("descricao"),error:!!(p.descricao&&r.descricao),helperText:typeof r.descricao=="string"?r.descricao:null})]})})]})})})}),e.jsx(R,{}),e.jsx(K,{sx:{p:2.5},children:e.jsx(h,{container:!0,justifyContent:"flex-end",alignItems:"center",children:e.jsx(h,{item:!0,children:e.jsxs(u,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(y,{color:"error",onClick:n,children:"Cancelar"}),e.jsx(y,{type:"submit",variant:"contained",disabled:x,children:"Cadastrar"})]})})})})]})})})},Be=({openModalCreate:d,modalToggler:n,category:a})=>{const o=()=>{n(!1)};s.useMemo(()=>!a&&e.jsx(H,{category:a??null,closeModal:o}),[a]);const r=a?e.jsx(S,{sx:{p:5},children:e.jsx(u,{direction:"row",justifyContent:"center",children:e.jsx(Te,{})})}):e.jsx(H,{category:a??null,closeModal:o});return e.jsx(ie,{open:d,onClose:o,"aria-labelledby":"modal-category-add-label","aria-describedby":"modal-category-add-description",sx:{"& .MuiPaper-root:focus":{outline:"none"}},children:e.jsx(Q,{sx:{width:"calc(100% - 48px)",minWidth:340,maxWidth:880,height:"auto",maxHeight:"calc(100vh - 48px)"},modal:!0,content:!1,children:e.jsx(ce,{sx:{maxHeight:"calc(100vh - 48px)","& .simplebar-content":{display:"flex",flexDirection:"column"}},children:r})})})};function We({handleClose:d,modalEdit:n,data:a}){const o=c=>({categoria:(a==null?void 0:a.categoria)??"",descricao:(a==null?void 0:a.descricao)??""}),r=O().shape({categoria:D().max(255).required("Nome é obrigatório"),descricao:D().max(500)}),p=L({initialValues:o(),validationSchema:r,enableReinitialize:!0,onSubmit:async(c,{setSubmitting:t,resetForm:I})=>{try{const f=await F.put(`/inventory/categories/${a.id}`,{categoria:c.categoria,descricao:c.descricao});I(),t(!1),d(!1)}catch(f){console.error(f)}}}),{errors:g,touched:x,handleSubmit:m,isSubmitting:C,getFieldProps:j,setFieldValue:i}=p;return e.jsx("div",{children:e.jsx(z,{open:n,keepMounted:!0,onClose:()=>{d(!1)},"aria-describedby":"alert-dialog-slide-description",children:e.jsx(S,{sx:{p:1,py:1.5},children:e.jsx(w,{children:e.jsx($,{value:p,children:e.jsxs(G,{autoComplete:"off",noValidate:!0,onSubmit:m,children:[e.jsxs(J,{dateAdapter:U,children:[e.jsx(q,{children:"Editar Categoria"}),e.jsx(R,{}),e.jsx(w,{sx:{p:2.5},children:e.jsx(h,{container:!0,spacing:3,children:e.jsx(h,{item:!0,xs:12,children:e.jsxs(h,{container:!0,spacing:3,children:[e.jsx(h,{item:!0,xs:12,sm:6,children:e.jsxs(u,{spacing:1,children:[e.jsx(M,{htmlFor:"categoria",children:"Nome Categoria"}),e.jsx(v,{fullWidth:!0,id:"categoria",placeholder:"Nome",...j("categoria"),error:!!(x.categoria&&g.categoria),helperText:typeof g.categoria=="string"?g.categoria:null})]})}),e.jsx(h,{item:!0,xs:12,children:e.jsxs(u,{spacing:1,children:[e.jsx(M,{htmlFor:"descricao",children:"Descrição"}),e.jsx(v,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...j("descricao"),error:!!(x.descricao&&g.descricao),helperText:typeof g.descricao=="string"?g.descricao:null})]})})]})})})})]}),e.jsxs(K,{children:[e.jsx(y,{color:"error",onClick:()=>{d(!1)},children:"Cancelar"}),e.jsx(y,{variant:"contained",type:"submit",children:"Cadastrar"})]})]})})})})})})}const He=(d,n,a,o)=>{const r=Fe(d.getValue(n),a);return o(r),r.passed};function ze({data:d,columns:n,modalToggler:a}){const o=X(),r=le(o.breakpoints.down("sm")),[p,g]=s.useState([{id:"id",desc:!0}]),[x,m]=s.useState({}),[C,j]=s.useState(""),i=de({data:d,columns:n,state:{sorting:p,rowSelection:x,globalFilter:C},enableRowSelection:!0,onSortingChange:g,onRowSelectionChange:m,onGlobalFilterChange:j,getRowCanExpand:()=>!0,getSortedRowModel:Se(),getFilteredRowModel:fe(),getCoreRowModel:be(),getPaginationRowModel:we(),getExpandedRowModel:De(),globalFilterFn:He});return ge(o.palette.primary.lighter,.1),e.jsxs(Q,{content:!1,children:[e.jsxs(u,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...r&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ue,{value:C??"",onFilterChange:c=>{j(String(c))},placeholder:"Buscar Categoria..."}),e.jsxs(u,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(Ee,{getState:i.getState,getAllColumns:i.getAllColumns,setSorting:g}),e.jsx(u,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(y,{variant:"contained",startIcon:e.jsx(Me,{}),onClick:a,children:"Adicionar Categoria"})})]})]}),e.jsx(xe,{children:e.jsxs(u,{children:[e.jsx(ve,{selected:Object.keys(x).length}),e.jsx(me,{children:e.jsxs(he,{children:[e.jsx(je,{children:i.getHeaderGroups().map(c=>e.jsx(k,{children:c.headers.map(t=>(t.column.columnDef.meta!==void 0&&t.column.getCanSort()&&Object.assign(t.column.columnDef.meta,{className:t.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(P,{...t.column.columnDef.meta,onClick:t.column.getToggleSortingHandler(),...t.column.getCanSort()&&t.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:t.isPlaceholder?null:e.jsxs(u,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(S,{children:A(t.column.columnDef.header,t.getContext())}),t.column.getCanSort()&&e.jsx(Ne,{column:t.column})]})},t.id)))},c.id))}),e.jsx(pe,{children:i.getRowModel().rows.length===0?e.jsx(k,{children:e.jsx(P,{colSpan:n.length,align:"center",children:e.jsx(Ce,{msg:"Nenhum registro encontrado"})})}):i.getRowModel().rows.map(c=>e.jsx(s.Fragment,{children:e.jsx(k,{children:c.getVisibleCells().map(t=>e.jsx(P,{...t.column.columnDef.meta,children:A(t.column.columnDef.cell,t.getContext())},t.id))})},c.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx(S,{sx:{p:2},children:e.jsx(ye,{setPageSize:i.setPageSize,setPageIndex:i.setPageIndex,getState:i.getState,getPageCount:i.getPageCount})})]})]})})]})}function qe(){const d=X(),[n,a]=s.useState(!1),[o,r]=s.useState(!1),[p,g]=s.useState(!1),[x,m]=s.useState(!1),[C,j]=s.useState(null),[i,c]=s.useState(""),[t,I]=s.useState(""),[f,Y]=s.useState(!1),[Z,_]=s.useState([]),[ee,T]=s.useState(!1),te=async()=>{try{T(!0);const l=await F.get("/inventory/categories");_(l.data.categorias.rows),T(!1)}catch(l){console.error("Erro ao buscar dados:",l),T(!1)}};s.useEffect(()=>{te()},[x,i,t,o,C,f,Y]);const ae=()=>{a(!n)},oe=()=>{m(!0)},E=()=>{r(!o)},re=s.useMemo(()=>[{id:"select",header:({table:l})=>e.jsx(W,{checked:l.getIsAllRowsSelected(),indeterminate:l.getIsSomeRowsSelected(),onChange:l.getToggleAllRowsSelectedHandler()}),cell:({row:l})=>e.jsx(W,{checked:l.getIsSelected(),disabled:!l.getCanSelect(),indeterminate:l.getIsSomeSelected(),onChange:l.getToggleSelectedHandler()}),meta:{className:"p-0"}},{accessorKey:"categoria",header:"Nome"},{accessorKey:"descricao",header:"Descrição"},{id:"actions",header:"Actions",cell:({row:l})=>e.jsxs(u,{direction:"row",spacing:1,children:[e.jsx(V,{title:"Editar",children:e.jsx(B,{color:"primary",onClick:()=>{j(l.original),oe()},children:e.jsx(ke,{})})}),e.jsx(V,{title:"Excluir",children:e.jsx(B,{color:"error",onClick:()=>{var N;I((N=l.original)==null?void 0:N.categoria),c(l.original.id),a(!0)},children:e.jsx(Ie,{})})})]})}],[d]);return e.jsxs(e.Fragment,{children:[ee?e.jsxs(S,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",children:[e.jsx(Pe,{}),e.jsx(b,{variant:"body2",color:"textSecondary",sx:{mt:2},children:"Carregando..."})]}):e.jsx(ze,{data:Z,columns:re,modalToggler:()=>{g(!0),j(null),E()}}),e.jsx(Ae,{id:i,title:i,open:n,handleClose:ae,name:t}),e.jsx(Be,{openModalCreate:o,modalToggler:E}),e.jsx(We,{modalEdit:x,handleClose:m,data:C})]})}export{qe as default};
