import{j as e,a3 as le,a4 as Pe,a5 as X,S as d,a6 as Re,T as z,h as T,k as $,r as m,c as je,a as x,a8 as ce,a9 as de,aa as fe,ab as _e,ac as Q,G as c,I as g,ad as I,p as N,af as k,ag as V,b as B,B as M,ae as me,ah as qe,M as ye,ai as Ne,n as ve,J as ke,K as Ve,aj as Be,Q as $e,U as Ee,W as We,X as Me,Y as ne,Z as se,$ as xe,a0 as Ae,ak as Le,al as Oe,P as ze,am as He,N as Je,an as Qe,ao as Ke,az as Ue,ap as ee,aA as Ge,aB as Xe,aC as Ye,aq as ie,aD as Ze}from"./index-82d1cb39.js";import{D as er,P as rr,R as or,r as tr,I as ge,a as ar}from"./index-7f621448.js";import{L as Ce,A as be,a as ue,C as nr,E as sr}from"./CircularWithPath-7e64b0d1.js";import{a as ir}from"./app-cb24a545.js";import{S as lr,H as cr}from"./SelectColumnSorting-5588f9e8.js";import{L as dr}from"./ListItem-44174649.js";function mr({id:t,title:v,open:_,handleClose:n,nome:h}){const a=async S=>{try{await $.delete(`/inventory/inventories/${S}`)}catch(D){throw console.error("Erro ao deletar o polo:",D),D}},o=async()=>{try{await a(t),n(),window.location.reload()}catch{}};return e.jsx(le,{open:_,onClose:n,keepMounted:!0,TransitionComponent:Pe,maxWidth:"xs","aria-labelledby":"column-delete-title","aria-describedby":"column-delete-description",children:e.jsx(X,{sx:{mt:2,my:1},children:e.jsxs(d,{alignItems:"center",spacing:3.5,children:[e.jsx(Re,{color:"error",sx:{width:72,height:72,fontSize:"1.75rem"},children:e.jsx(er,{})}),e.jsxs(d,{spacing:2,children:[e.jsx(z,{variant:"h4",align:"center",children:"Você tem certeza?"}),e.jsxs(z,{align:"center",children:["Você está deletando o item",e.jsx(z,{variant:"subtitle1",component:"span",sx:{ml:.5},children:h}),e.jsx(z,{variant:"subtitle1",component:"span",sx:{ml:.5}}),", esta operação não pode ser desfeita."]})]}),e.jsxs(d,{direction:"row",spacing:2,sx:{width:1},children:[e.jsx(T,{fullWidth:!0,onClick:n,color:"secondary",variant:"outlined",children:"Cancelar"}),e.jsx(T,{fullWidth:!0,color:"error",variant:"contained",onClick:o,autoFocus:!0,children:"Deletar"})]})]})})})}const ur=t=>({nome_item:"",polo:"",departamento:"",sub_departamento:"",sala:"",categoria:"",valor:"",quantidade:"",descricao:"",imagem:"",numero_nota_fiscal:"",numero_serie:"",numero_folha:"",data_emissao:"",cnpj_emissor:"",fornecedor:""}),hr=({room:t,closeModal:v})=>{const[_,n]=m.useState(null),[h,a]=m.useState(null),o=m.useRef(null),S=m.useRef(null),[D,f]=m.useState(!1),[C,b]=m.useState(!1),[w,l]=m.useState([]),[P,i]=m.useState(),[E,j]=m.useState(),[L,A]=m.useState([]),[O,H]=m.useState([]),[K,U]=m.useState([]),J=je().shape({nome_item:x().max(255).required("Nome é obrigatorio"),polo:x().max(255).required("Nome do Polo é obrigatorio"),departamento:x().max(255),fornecedor:x().max(255),sub_departamento:x().max(255),sala:x().max(255).required("Sala é obrigatorio"),categoria:x().max(255).required("Categria é obrigatorio"),valor:x().max(255).required("Valor é obrigatorio"),quantidade:x().max(255).required("Quantidade é obrigatorio"),descricao:x().max(500),numero_nota_fiscal:x().max(255),numero_serie:x().max(255),numero_folha:x().max(255),data_emissao:x().max(255),cnpj_emissor:x().max(255)}),F=ce({initialValues:ur(),validationSchema:J,enableReinitialize:!0,onSubmit:async(r,{setSubmitting:q})=>{try{const y=new FormData;if(y.append("nome_item",r.nome_item),y.append("polo_id",r.polo),y.append("departamento_id",r.departamento),y.append("sub_departamento_id",r.sub_departamento_id),y.append("sala_id",r.sala),y.append("categoria_id",r.categoria),y.append("fornecedor_id",r.fornecedores),y.append("valor",r.valor.replace(/\D/g,"")),y.append("quantidade",r.quantidade),y.append("descricao",r.descricao),y.append("numero_nota_fiscal",r.numero_nota_fiscal),y.append("numero_serie",r.numero_serie),y.append("numero_folha",r.numero_folha),y.append("data_emissao",r.data_emissao),y.append("cnpj_emissor",r.cnpj_emissor),h){const De=await(await fetch(h)).blob();y.append("imagem",De,"captured-photo.png")}await $.post("/inventory/inventories",y,{headers:{"Content-Type":"multipart/form-data"}}),q(!1),v(),window.location.reload()}catch(y){console.error("Error saving data:",y)}}}),{errors:u,touched:s,handleSubmit:Y,isSubmitting:re,getFieldProps:R,setFieldValue:Z}=F,oe=r=>r&&r.replace(/[^\d]/g,"").replace(/(\d)(\d{2})$/,"$1.$2").replace(/\B(?=(\d{3})+(?!\d))/g,"."),te=async r=>{const q=oe(r.target.value);await Z("valor",q)},ae=r=>r.replace(/\D/g,"").replace(/^(\d{2})(\d)/,"$1.$2").replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3").replace(/\.(\d{3})(\d)/,".$1/$2").replace(/(\d{4})(\d)/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1"),p=async r=>{const{value:q}=r.target,y=ae(q);await Z("cnpj_emissor",y)},W=async()=>{try{b(!0);const r=await navigator.mediaDevices.getUserMedia({video:!0});setTimeout(async()=>{n(r),o.current&&(o.current.srcObject=r,await o.current.play()),b(!1)},500),f(!0)}catch(r){console.error("Error accessing camera:",r),b(!1)}},G=()=>{_&&(_.getTracks().forEach(r=>{r.stop()}),n(null)),f(!1)},he=()=>{if(o.current&&S.current){const r=S.current.getContext("2d");if(r){S.current.width=o.current.videoWidth,S.current.height=o.current.videoHeight,r.drawImage(o.current,0,0);const q=S.current.toDataURL("image/png");a(q),G()}}},Se=()=>{a(null)},we=async()=>{try{const r=await $.get("/inventory/polo/details");l(r.data.polos)}catch(r){console.error("Error fetching data:",r)}};m.useEffect(()=>{we()},[]);const Fe=async()=>{try{const r=await $.get("/inventory/categories");H(r.data.categorias.rows)}catch(r){console.error("Error fetching data:",r)}};m.useEffect(()=>{Fe()},[]);const pe=async r=>{try{const q=await $.get(`/inventory/polo/associations/${r}`);i(q.data.polos.departamentos),j(q.data.polos.departamentos.flatMap(y=>y.sub_departamentos)),A(q.data.polos.salas),await F.setFieldValue("departamento",""),await F.setFieldValue("sub_departamento",""),await F.setFieldValue("polo",r)}catch(q){console.error("Error fetching data:",q)}};m.useEffect(()=>{pe(F.values.polo)},[]);const Ie=async()=>{try{const r=await $.get("/inventory/suppliers/active");U(r.data.fornecedores.rows),console.log(r.data.fornecedores)}catch(r){console.error("Error fetching data:",r)}};return m.useEffect(()=>{Ie()},[]),e.jsx(de,{value:F,children:e.jsx(Ce,{dateAdapter:be,children:e.jsxs(fe,{autoComplete:"off",noValidate:!0,onSubmit:Y,children:[e.jsx(_e,{children:"Novo inventário"}),e.jsx(Q,{}),e.jsx(X,{sx:{p:2.5},children:e.jsx(c,{container:!0,spacing:3,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"novo item",children:"Nome do item *"}),e.jsx(I,{fullWidth:!0,id:"nome_item",placeholder:"Nome",...R("nome_item"),error:!!(s.nome_item&&u.nome_item),helperText:typeof u.nome_item=="string"?u.nome_item:""})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"polo",children:"Polo *"}),e.jsxs(N,{fullWidth:!0,error:!!(s.polo&&u.polo),children:[e.jsx(k,{id:"polo",placeholder:"Nome",...R("polo"),value:F.values.polo,onChange:async r=>{await pe(r.target.value)},children:w==null?void 0:w.map(r=>e.jsx(V,{value:r.id,children:r.polo},"polo"+r.id))}),s.polo&&u.polo&&e.jsx(B,{children:typeof u.polo=="string"?u.polo:""})]})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"departamento",children:"Departamento "}),e.jsxs(N,{fullWidth:!0,error:!!(s.departamento&&u.departamento),children:[e.jsx(k,{id:"departamento",placeholder:"Nome",...R("departamento"),value:F.values.departamento,children:P==null?void 0:P.map(r=>e.jsx(V,{value:r.id,children:r.departamento},"departamento_"+r.id))}),s.departamento&&u.departamento&&e.jsx(B,{children:typeof u.departamento=="string"?u.departamento:""})]})]})}),e.jsx(c,{item:!0,xs:12,sm:3,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"sub_departamento",children:"subDepartamento "}),e.jsxs(N,{fullWidth:!0,error:!!(s.sub_departamento&&u.sub_departamento),children:[e.jsx(k,{id:"sub_departamento",placeholder:"Nome",...R("sub_departamento_id"),value:F.values.sub_departamento_id,children:E==null?void 0:E.map(r=>e.jsx(V,{value:r.id,children:r.sub_departamento},"sub"+r.id))}),s.sub&&u.sub_departamento&&e.jsx(B,{children:typeof u.sub_departamento})]})]})}),e.jsx(c,{item:!0,xs:12,sm:3,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"sala",children:"Sala *"}),e.jsxs(N,{fullWidth:!0,error:!!(s.sala&&u.sala),children:[e.jsx(k,{id:"sala",placeholder:"Nome",...R("sala"),value:F.values.sala,children:L.map(r=>e.jsx(V,{value:r.id,children:r.sala},"sala"+r.id))}),s.sala&&u.sala&&e.jsx(B,{children:typeof u.sala=="string"?u.sala:""})]})]})}),e.jsx(c,{item:!0,xs:12,sm:3,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"categoria",children:"Categoria *"}),e.jsxs(N,{fullWidth:!0,error:!!(s.categoria&&u.categoria),children:[e.jsx(k,{id:"categoria",placeholder:"Nome",...R("categoria"),value:F.values.categoria,children:O.map(r=>e.jsx(V,{value:r.id,children:r.categoria},"categoria_"+r.id))}),s.categoria&&u.categoria&&e.jsx(B,{children:typeof u.categoria=="string"?u.categoria:""})]})]})}),e.jsx(c,{item:!0,xs:12,sm:3,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"fornecedores",children:"Fornecedor *"}),e.jsxs(N,{fullWidth:!0,error:!!(s.fornecedores&&u.fornecedores),children:[e.jsx(k,{id:"fornecedores",placeholder:"Nome",...R("fornecedores"),value:F.values.fornecedores,children:K.map(r=>e.jsx(V,{value:r.id,children:r.nome},"fornecedor"+r.id))}),s.fornecedores&&u.fornecedores&&e.jsx(B,{children:typeof u.fornecedores})]})]})}),e.jsx(c,{item:!0,xs:12,sm:2,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"valor",children:"Valor *"}),e.jsx(I,{fullWidth:!0,id:"valor",placeholder:"Valor",...R("valor"),onChange:te,error:!!(s.valor&&u.valor),helperText:e.jsx(e.Fragment,{children:s.valor&&u.valor})})]})}),e.jsx(c,{item:!0,xs:12,sm:2,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"quantidade",children:"Quantidade *"}),e.jsx(I,{fullWidth:!0,id:"quantidade",type:"number",placeholder:"Quantidade",...R("quantidade"),error:!!(s.quantidade&&u.quantidade),helperText:e.jsx(e.Fragment,{children:s.quantidade&&u.quantidade}),inputProps:{min:0}})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"numero_nota_fiscal",children:"Nota fiscal"}),e.jsx(I,{fullWidth:!0,id:"numero_nota_fiscal",placeholder:"nota fiscal",...R("numero_nota_fiscal"),error:!!(s.numero_nota_fiscal&&u.numero_nota_fiscal),helperText:typeof s.numero_nota_fiscal=="string"?s.numero_nota_fiscal&&u.numero_nota_fiscal:""})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"numero_serie",children:"Numero de série"}),e.jsx(I,{fullWidth:!0,id:"numero_serie",placeholder:"Numero de série",...R("numero_serie"),error:!!(s.numero_serie&&u.numero_serie),helperText:e.jsx(e.Fragment,{children:s.numero_serie&&u.numero_serie})})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"numero_folha",children:"Número da folha "}),e.jsx(I,{fullWidth:!0,id:"numero_folha",placeholder:"Número da folha",...R("numero_folha"),error:!!(s.numero_folha&&u.numero_folha),helperText:typeof s.numero_folha=="string"?u.numero_folha&&s.numero_folha:""})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"data_emissao",children:"Data de emissão"}),e.jsx(I,{fullWidth:!0,id:"data_emissao",type:"date",placeholder:"Data de emissão",inputProps:{max:"3000-12-31"},...R("data_emissao"),error:!!(s.data_emissao&&u.data_emissao),helperText:e.jsx(e.Fragment,{children:s.data_emissao&&u.data_emissao?u.data_emissao:""})})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"cnpj_emissor",children:"CNPJ do emissor"}),e.jsx(I,{fullWidth:!0,id:"cnpj_emissor",placeholder:"CNPJ do emissor",value:F.values.cnpj_emissor||"",onChange:p,error:!!(s.cnpj_emissor&&u.cnpj_emissor),helperText:typeof s.cnpj_emissor=="string"?u.cnpj_emissor&&s.cnpj_emissor:""})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"descricao",children:"Descrição"}),e.jsx(I,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...R("descricao"),error:!!(s.descricao&&u.descricao),helperText:typeof s.descricao=="string"?u.descricao&&s.descricao:""})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(d,{spacing:1,alignItems:"center",children:[C&&e.jsx(c,{item:!0,xs:4,children:e.jsx(M,{style:{display:"flex",width:"20%",height:"auto",marginTop:20,justifyContent:"center",alignItems:"center"},children:e.jsx(ue,{})})}),!D&&!h&&!C&&e.jsx(T,{variant:"contained",onClick:W,children:"Abrir Câmera"}),D&&e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:o,style:{width:"20%",height:"auto",marginTop:20}}),e.jsx("canvas",{ref:S,style:{display:"none"}}),e.jsxs(d,{direction:"row",spacing:2,style:{marginTop:20},children:[e.jsx(T,{variant:"outlined",color:"error",onClick:G,children:"Cancelar"}),e.jsx(T,{variant:"contained",onClick:he,children:"Tirar Foto"})]})]}),h&&e.jsxs(d,{spacing:2,style:{marginTop:20,alignItems:"center"},children:[e.jsx("img",{src:h,alt:"Captured",style:{width:"20%",height:"auto"}}),e.jsx(T,{variant:"outlined",color:"error",onClick:Se,children:"Remover Foto"})]})]})})]})})})}),e.jsx(Q,{}),e.jsx(me,{sx:{p:2.5},children:e.jsx(c,{container:!0,justifyContent:"flex-end",alignItems:"center",children:e.jsx(c,{item:!0,children:e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(T,{color:"error",onClick:v,children:"Cancelar"}),e.jsx(T,{type:"submit",variant:"contained",disabled:re,children:"Cadastrar"})]})})})})]})})})},pr=({openModalCreate:t,modalToggler:v,inventory:_})=>{const n=()=>{v(!1)},h=_?e.jsx(M,{sx:{p:5},children:e.jsx(d,{direction:"row",justifyContent:"center",children:e.jsx(nr,{})})}):e.jsx(hr,{room:_??null,closeModal:n});return e.jsx(qe,{open:t,onClose:n,"aria-labelledby":"modal-inventory-add-label","aria-describedby":"modal-inventory-add-description",sx:{"& .MuiPaper-root:focus":{outline:"none"}},children:e.jsx(ye,{sx:{width:"calc(100% - 48px)",minWidth:340,maxWidth:880,height:"auto",maxHeight:"calc(100vh - 48px)"},modal:!0,content:!1,children:e.jsx(Ne,{sx:{maxHeight:"calc(100vh - 48px)","& .simplebar-content":{display:"flex",flexDirection:"column"}},children:h})})})},xr=({data:t})=>{const[v,_]=m.useState(null),[n,h]=m.useState(null),a=m.useRef(null),o=m.useRef(null),[S,D]=m.useState(!1),[f,C]=m.useState(!1),[b,w]=m.useState([]),[l,P]=m.useState(),[i,E]=m.useState(),[j,L]=m.useState([]),[A,O]=m.useState([]),[H,K]=m.useState([]),U=p=>({nome_item:(t==null?void 0:t.nome_item)||"",polo:(t==null?void 0:t.polo.id)||"",departamento:(t==null?void 0:t.departamento.id)||"",sub_departamento:(t==null?void 0:t.sub_departamento.id)||"",sala:(t==null?void 0:t.sala.id)||"",categoria:(t==null?void 0:t.categoria.id)||"",valor:(t==null?void 0:t.valor)||"",quantidade:(t==null?void 0:t.quantidade)||"",descricao:(t==null?void 0:t.descricao)||"",imagem:(t==null?void 0:t.imagem)||"",numero_nota_fiscal:(t==null?void 0:t.numero_nota_fiscal)||"",numero_serie:(t==null?void 0:t.numero_serie)||"",numero_folha:(t==null?void 0:t.numero_folha)||"",data_emissao:(t==null?void 0:t.data_emissao)||"",cnpj_emissor:(t==null?void 0:t.cnpj_emissor)||"",fornecedor:(t==null?void 0:t.fornecedor.id)||""}),J=je().shape({nome_item:x().max(255).required("Nome é obrigatorio"),polo:x().max(255).required("Nome do Polo é obrigatorio"),departamento:x().max(255).required("Departamento é obrigatorio"),fornecedor:x().max(255),sub_departamento:x().max(255),sala:x().max(255).required("Sala é obrigatorio"),categoria:x().max(255).required("Categria é obrigatorio"),valor:x().max(255).required("Valor é obrigatorio"),quantidade:x().max(255).required("Quantidade é obrigatorio"),descricao:x().max(500),numero_nota_fiscal:x().max(255),numero_serie:x().max(255),numero_folha:x().max(255),data_emissao:x().max(255),cnpj_emissor:x().max(255)}),F=p=>p&&p.replace(/[^\d]/g,"").replace(/(\d)(\d{2})$/,"$1.$2").replace(/\B(?=(\d{3})+(?!\d))/g,"."),u=p=>p.replace(/\D/g,"").replace(/^(\d{2})(\d)/,"$1.$2").replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3").replace(/\.(\d{3})(\d)/,".$1/$2").replace(/(\d{4})(\d)/,"$1-$2").replace(/(-\d{2})\d+?$/,"$1"),s=async()=>{try{C(!0);const p=await navigator.mediaDevices.getUserMedia({video:!0});setTimeout(async()=>{_(p),a.current&&(a.current.srcObject=p,await a.current.play()),C(!1)},500),D(!0)}catch(p){console.error("Error accessing camera:",p),C(!1)}},Y=()=>{v&&(v.getTracks().forEach(p=>{p.stop()}),_(null)),D(!1)},re=()=>{if(a.current&&o.current){const p=o.current.getContext("2d");if(p){o.current.width=a.current.videoWidth,o.current.height=a.current.videoHeight,p.drawImage(a.current,0,0);const W=o.current.toDataURL("image/png");h(W),Y()}}},R=()=>{h(null)},Z=async()=>{try{const p=await $.get("/inventory/polo/details");w(p.data.polos)}catch(p){console.error("Error fetching data:",p)}},oe=async()=>{try{const p=await $.get("/inventory/categories");O(p.data.categorias.rows)}catch(p){console.error("Error fetching data:",p)}},te=async p=>{try{const W=await $.get(`/inventory/polo/associations/${p}`);P(W.data.polos.departamentos),E(W.data.polos.departamentos.flatMap(G=>G.sub_departamentos)),L(W.data.polos.salas)}catch(W){console.error("Error fetching data:",W)}},ae=async()=>{try{const p=await $.get("/inventory/suppliers");K(p.data.fornecedores.rows)}catch(p){console.error("Error fetching data:",p)}};return m.useMemo(()=>({getInitialValues:U,RoomSchema:J,departamentos:l,sub_departamentos:i,salas:j,categorias:A,formatCurrency:F,formatCNPJ:u,isLoading:f,isCameraOpen:S,capturedImage:n,videoRef:a,canvasRef:o,startCamera:s,stopCamera:Y,capturePhoto:re,removePhoto:R,fetchPolos:Z,fetchCategorias:oe,handlePoloChange:te,fetchFornecedores:ae,fornecedores:H,polos:b}),[l,i,j,A,f,S,n,a,o,H,b,J])};function gr({handleClose:t,modalEdit:v,data:_}){var w,l,P;const n=xr({data:_}),h=ce({initialValues:n.getInitialValues(_),validationSchema:n.RoomSchema,enableReinitialize:!0,onSubmit:async(i,{setSubmitting:E})=>{try{const j=new FormData;if(j.append("nome_item",i.nome_item),j.append("polo_id",i.polo),j.append("departamento_id",i.departamento),j.append("sub_departamento_id",i.sub_departamento),j.append("sala_id",i.sala),j.append("categoria_id",i.categoria),j.append("fornecedor_id",i.fornecedor),j.append("valor",i.valor),j.append("quantidade",i.quantidade),j.append("descricao",i.descricao),j.append("numero_nota_fiscal",i.numero_nota_fiscal),j.append("numero_serie",i.numero_serie),j.append("numero_folha",i.numero_folha),j.append("data_emissao",i.data_emissao),j.append("cnpj_emissor",i.cnpj_emissor),n.capturedImage){const A=await(await fetch(n.capturedImage)).blob();j.append("imagem",A,"captured-photo.png")}await $.put(`/inventory/inventories/${_.id}`,j,{headers:{"Content-Type":"multipart/form-data"}}),E(!1),t(!1),window.location.reload()}catch(j){console.error("Error saving data:",j)}}}),{errors:a,touched:o,handleSubmit:S,isSubmitting:D,getFieldProps:f,setFieldValue:C}=h;m.useEffect(()=>{v&&(n.fetchPolos(),n.fetchCategorias(),n.fetchFornecedores(),n.handlePoloChange(_==null?void 0:_.polo.id))},[v]);const b=async i=>{const{value:E}=i.target,j=n.formatCNPJ(E);await C("cnpj_emissor",j)};return e.jsx(le,{open:v,onClose:()=>t(!1),"aria-describedby":"alert-dialog-slide-description",children:e.jsx(M,{sx:{p:1,py:1.5},children:e.jsx(X,{children:e.jsx(de,{value:h,children:e.jsx(Ce,{dateAdapter:be,children:e.jsxs(fe,{autoComplete:"off",noValidate:!0,onSubmit:S,children:[e.jsx(_e,{children:"Editar inventário "}),e.jsx(Q,{}),e.jsx(X,{sx:{p:2.5},children:e.jsx(c,{container:!0,spacing:3,children:e.jsx(c,{item:!0,xs:12,children:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"novo item",children:"Nome do item *"}),e.jsx(I,{fullWidth:!0,id:"nome_item",placeholder:"Nome",...f("nome_item"),error:!!(o.nome_item&&a.nome_item),helperText:e.jsx(e.Fragment,{children:o.nome_item&&a.nome_item})})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"polo",children:"Polo *"}),e.jsxs(N,{fullWidth:!0,error:!!(o.polo&&a.polo),children:[e.jsx(k,{id:"polo",placeholder:"Nome",...f("polo"),value:h.values.polo,onChange:i=>{C("polo",i.target.value),n.handlePoloChange(i.target.value)},children:(w=n.polos)==null?void 0:w.map(i=>e.jsx(V,{value:i.id,children:i.polo},"polo"+i.id))}),o.polo&&a.polo&&e.jsx(B,{children:typeof a.polo})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"departamento",children:"Departamento "}),e.jsxs(N,{fullWidth:!0,error:!!(o.departamento&&a.departamento),children:[e.jsx(k,{id:"departamento",placeholder:"Nome",...f("departamento"),value:h.values.departamento,children:(l=n.departamentos)==null?void 0:l.map(i=>e.jsx(V,{value:i.id,children:i.departamento},"departamento_"+i.id))}),o.departamento&&a.departamento&&e.jsx(B,{children:typeof a.departamento})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"sub_departamento",children:"subDepartamento"}),e.jsxs(N,{fullWidth:!0,error:!!(o.sub_departamento&&a.sub_departamento),children:[e.jsx(k,{id:"sub_departamento",placeholder:"Nome",...f("sub_departamento"),value:h.values.sub_departamento,children:(P=n.sub_departamentos)==null?void 0:P.map(i=>e.jsx(V,{value:i.id,children:i.sub_departamento},"sub"+i.id))}),o.sub&&a.sub_departamento&&e.jsx(B,{children:typeof a.sub_departamento})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"sala",children:"Sala *"}),e.jsxs(N,{fullWidth:!0,error:!!(o.sala&&a.sala),children:[e.jsx(k,{id:"sala",placeholder:"Nome",...f("sala"),value:h.values.sala,children:n.salas.map(i=>e.jsx(V,{value:i.id,children:i.sala},"sala"+i.id))}),o.sala&&a.sala&&e.jsx(B,{children:typeof a.sala})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"categoria",children:"Categoria *"}),e.jsxs(N,{fullWidth:!0,error:!!(o.categoria&&a.categoria),children:[e.jsx(k,{id:"categoria",placeholder:"Nome",...f("categoria"),value:h.values.categoria,children:n.categorias.map(i=>e.jsx(V,{value:i.id,children:i.categoria},"categoria_"+i.id))}),o.categoria&&a.categoria&&e.jsx(B,{children:typeof a.categoria})]})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"fornecedores",children:"Fornecedores *"}),e.jsxs(N,{fullWidth:!0,error:!!(o.fornecedores&&a.fornecedores),children:[e.jsx(k,{id:"fornecedores",placeholder:"Nome",...f("fornecedores"),value:h.values.fornecedor,children:n.fornecedores.map(i=>e.jsx(V,{value:i.id,children:i.nome},"fornecedor"+i.id))}),o.fornecedores&&a.fornecedores&&e.jsx(B,{children:typeof a.fornecedores})]})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"valor",children:"Valor *"}),e.jsx(I,{fullWidth:!0,id:"valor",placeholder:"Valor",...f("valor"),onChange:()=>{},error:!!(o.valor&&a.valor),helperText:typeof o.valor=="string"?a.valor&&o.valor:""})]})}),e.jsx(c,{item:!0,xs:12,sm:2,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"quantidade",children:"Quantidade *"}),e.jsx(I,{fullWidth:!0,id:"quantidade",type:"number",placeholder:"Quantidade",...f("quantidade"),error:!!(o.quantidade&&a.quantidade),helperText:typeof o.quantidade=="string"?a.quantidade&&o.quantidade:"",inputProps:{min:0}})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"numero_nota_fiscal",children:"Nota fiscal"}),e.jsx(I,{fullWidth:!0,id:"numero_nota_fiscal",placeholder:"nota fiscal",...f("numero_nota_fiscal"),error:!!(o.numero_nota_fiscal&&a.numero_nota_fiscal),helperText:typeof o.numero_nota_fiscal=="string"?a.numero_nota_fiscal&&o.numero_nota_fiscal:""})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"numero_serie",children:"Número de série"}),e.jsx(I,{fullWidth:!0,id:"numero_serie",placeholder:"Número de série",...f("numero_serie"),error:!!(o.numero_serie&&a.numero_serie),helperText:typeof o.numero_serie=="string"?a.numero_serie&&o.numero_serie:""})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"numero_folha",children:"Numero da folha "}),e.jsx(I,{fullWidth:!0,id:"numero_folha",placeholder:"Numero da folha",...f("numero_folha"),error:!!(o.numero_folha&&a.numero_folha),helperText:typeof o.numero_folha=="string"?a.numero_folha&&o.numero_folha:""})]})}),e.jsx(c,{item:!0,xs:12,sm:4,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"data_emissao",children:"Data de emissão "}),e.jsx(I,{fullWidth:!0,id:"data_emissao",type:"date",placeholder:"Data de emissão ",...f("data_emissao"),error:!!(o.data_emissao&&a.data_emissao),helperText:typeof o.data_emissao=="string"?a.data_emissao&&o.data_emissao:""})]})}),e.jsx(c,{item:!0,xs:12,sm:6,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"cnpj_emissor",children:"CNPJ do emissor"}),e.jsx(I,{fullWidth:!0,id:"cnpj_emissor",placeholder:"CNPJ do emissor",value:h.values.cnpj_emissor||"",onChange:b,error:!!(o.cnpj_emissor&&a.cnpj_emissor),helperText:typeof o.cnpj_emissor=="string"?a.cnpj_emissor&&o.cnpj_emissor:""})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(d,{spacing:1,children:[e.jsx(g,{htmlFor:"descricao",children:"Descrição"}),e.jsx(I,{fullWidth:!0,id:"descricao",multiline:!0,minRows:2,placeholder:"Descrição",...f("descricao"),error:!!(o.descricao&&a.descricao),helperText:typeof o.descricao=="string"?a.descricao&&o.descricao:""})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(d,{spacing:1,sx:{alignItems:"center",justifyContent:"center"},children:[n.isLoading&&e.jsx(M,{style:{display:"flex",width:"20%",height:"auto",marginTop:20,justifyContent:"center",alignItems:"center"},children:e.jsx(ue,{})}),!n.isCameraOpen&&!h.values.img&&!n.isLoading&&e.jsx(T,{variant:"contained",onClick:n.startCamera,children:"alterar imagem"}),n.isCameraOpen&&e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:n.videoRef,style:{width:"20%",height:"auto",marginTop:20}}),e.jsx("canvas",{ref:n.canvasRef,style:{display:"none"}}),e.jsxs(d,{direction:"row",spacing:2,style:{marginTop:20},children:[e.jsx(T,{variant:"outlined",color:"error",onClick:n.stopCamera,children:"Cancelar"}),e.jsx(T,{variant:"contained",onClick:n.capturePhoto,children:"Tirar Foto"})]})]}),n.capturedImage&&e.jsxs(d,{spacing:2,style:{marginTop:20,alignItems:"center"},children:[e.jsx("img",{src:n.capturedImage,alt:"Captured",style:{width:"20%",height:"auto"}}),e.jsx(T,{variant:"outlined",color:"error",onClick:n.removePhoto,children:"Remover Foto"})]}),!n.capturedImage&&!n.isCameraOpen&&e.jsx("img",{src:`${ir.api_url}/${h.values.imagem}`,alt:"Sala",style:{width:"20%",height:"auto",marginTop:20}})]})})]})})})}),e.jsx(Q,{}),e.jsx(me,{sx:{p:2.5},children:e.jsx(c,{container:!0,justifyContent:"flex-end",alignItems:"center",children:e.jsx(c,{item:!0,children:e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(T,{color:"error",onClick:()=>t(!1),children:"Cancelar"}),e.jsx(T,{type:"submit",variant:"contained",disabled:D,children:"Cadastrar"})]})})})})]})})})})})})}const jr=(t,v,_,n)=>{const h=tr(t.getValue(v),_);return n(h),h.passed};function fr({data:t,columns:v,modalToggler:_}){const n=ve(),h=ke(n.breakpoints.down("sm")),[a,o]=m.useState([{id:"id",desc:!0}]),[S,D]=m.useState({}),[f,C]=m.useState(""),b=Ve({data:t,columns:v,state:{sorting:a,rowSelection:S,globalFilter:f},enableRowSelection:!0,onSortingChange:o,onRowSelectionChange:D,onGlobalFilterChange:C,getRowCanExpand:()=>!0,getSortedRowModel:ze(),getFilteredRowModel:He(),getCoreRowModel:Je(),getPaginationRowModel:Qe(),getExpandedRowModel:Ke(),globalFilterFn:jr,debugTable:!0});return e.jsxs(ye,{content:!1,children:[e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...h&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(Be,{value:f??"",onFilterChange:w=>{C(String(w))},placeholder:`Buscar ${t.length} ...`}),e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(lr,{getState:b.getState,getAllColumns:b.getAllColumns,setSorting:o}),e.jsx(d,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(T,{variant:"contained",startIcon:e.jsx(rr,{}),onClick:_,children:"Adicionar Inventario"})})]})]}),e.jsx($e,{children:e.jsxs(d,{children:[e.jsx(or,{selected:Object.keys(S).length}),e.jsx(Ee,{children:e.jsxs(We,{children:[e.jsx(Me,{children:b.getHeaderGroups().map(w=>e.jsx(ne,{children:w.headers.map(l=>(l.column.columnDef.meta!==void 0&&l.column.getCanSort()&&Object.assign(l.column.columnDef.meta,{className:l.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(se,{...l.column.columnDef.meta,onClick:l.column.getToggleSortingHandler(),...l.column.getCanSort()&&l.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:l.isPlaceholder?null:e.jsxs(d,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(M,{children:xe(l.column.columnDef.header,l.getContext())}),l.column.getCanSort()&&e.jsx(cr,{column:l.column})]})},l.id)))},w.id))}),e.jsx(Ae,{children:b.getRowModel().rows.length===0?e.jsx(ne,{children:e.jsx(se,{colSpan:v.length,align:"center",children:e.jsx(Le,{msg:"Nenhum registro encontrado."})})}):b.getRowModel().rows.map(w=>e.jsx(m.Fragment,{children:e.jsx(ne,{children:w.getVisibleCells().map(l=>e.jsx(se,{...l.column.columnDef.meta,children:xe(l.column.columnDef.cell,l.getContext())},l.id))})},w.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(M,{sx:{p:2},children:e.jsx(Oe,{setPageSize:b.setPageSize,setPageIndex:b.setPageIndex,getState:b.getState,getPageCount:b.getPageCount})})]})]})})]})}function _r({handleClose:t,tagsInvetory:v,data:_}){const[n,h]=m.useState(1),a=10,[o,S]=m.useState(null),D=()=>{},C=ce({initialValues:(l=>({id:l==null?void 0:l.id,nome_item:(l==null?void 0:l.nome_item)??"",etiquetas:Array.isArray(l==null?void 0:l.etiquetas)?l==null?void 0:l.etiquetas:[]}))(_),enableReinitialize:!0,onSubmit:()=>{}}),b=l=>{S(l)},w=()=>{S(null)};return e.jsx(le,{open:v,keepMounted:!0,onClose:()=>t(!1),"aria-describedby":"alert-dialog-slide-description",children:e.jsx(M,{sx:{p:1,py:1.5},children:e.jsx(X,{children:e.jsx(de,{value:C,children:e.jsxs(c,{id:"print",container:!0,spacing:2.25,children:[e.jsx(c,{item:!0,xs:12,justifyContent:"center",children:e.jsxs(M,{sx:{textAlign:"center",justifyContent:"center"},children:[o===null?e.jsx(z,{variant:"h1",gutterBottom:!0,children:C.values.nome_item}):e.jsxs(z,{variant:"h4",gutterBottom:!0,children:[C.values.etiquetas[o].nome," "]}),o===null?e.jsx(Ue,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:C.values.etiquetas.slice((n-1)*a,n*a).map((l,P)=>e.jsxs(dr,{sx:{justifyContent:"center",display:"flex",width:"100%"},children:[e.jsx(ee,{title:"Clique para visualizar a etiqueta",children:e.jsx(Ge,{avatar:e.jsx(Xe,{children:e.jsx("img",{src:l.qrcode,alt:`Etiqueta ${P+1}`,style:{width:"100%",height:"100%",objectFit:"cover"}})}),label:l.nome,color:"success",variant:"light",size:"small",sx:{fontSize:"1rem",display:"flex",alignItems:"center"},onClick:()=>{b(P)}})}),e.jsx(T,{variant:"light",size:"small",onClick:D,children:"Gerar Etiqueta"})]},P))}):e.jsx(M,{sx:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:e.jsx("img",{src:C.values.etiquetas[o].qrcode,alt:"Etiqueta Ampliada",style:{width:"200px",height:"200px"}})})]})}),o===null&&e.jsxs(e.Fragment,{children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(Q,{})}),e.jsx(c,{item:!0,xs:12,sx:{display:"flex",justifyContent:"center"},children:e.jsx(Ye,{count:Math.ceil(C.values.etiquetas.length/a),page:n,onChange:(l,P)=>{h(P)}})})]}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(me,{sx:{justifyContent:o!==null?"flex-end":"space-between"},children:[o!==null&&e.jsx(T,{onClick:w,color:"primary",children:"Voltar à Lista"}),e.jsx(T,{color:"error",onClick:()=>t(!1),children:"Fechar"})]})})]})})})})})}function Fr(){const t=ve(),[v,_]=m.useState(!1),[n,h]=m.useState(!1),[a,o]=m.useState(!1),[S,D]=m.useState(!1),[f,C]=m.useState(null),[b,w]=m.useState(""),[l,P]=m.useState(""),[i,E]=m.useState([]),[j,L]=m.useState(!1),[A,O]=m.useState(!1),H=async()=>{try{O(!0);const s=await $.get("/inventory/inventories");E(s.data.inventarios.rows),O(!1)}catch(s){console.error("Erro ao buscar dados:",s),O(!1)}};m.useEffect(()=>{H()},[]);const K=()=>{_(!v)},U=()=>{D(!0)},J=()=>{L(!0)},F=()=>{h(!n)},u=m.useMemo(()=>[{id:"select",header:({table:s})=>e.jsx(ge,{checked:s.getIsAllRowsSelected(),indeterminate:s.getIsSomeRowsSelected(),onChange:s.getToggleAllRowsSelectedHandler()}),cell:({row:s})=>e.jsx(ge,{checked:s.getIsSelected(),disabled:!s.getCanSelect(),indeterminate:s.getIsSomeSelected(),onChange:s.getToggleSelectedHandler()}),meta:{className:"p-0"}},{accessorKey:"nome_item",header:"Cod/Item"},{accessorKey:"polo.polo",header:"Polo"},{accessorKey:"departamento.departamento",header:"Departamento"},{accessorKey:"sala.sala",header:"Sala"},{accessorKey:"valor",header:"Valor do lote"},{accessorKey:"quantidade",header:"Quantidade de itens"},{id:"actions",header:"Ações",cell:({row:s})=>e.jsxs(d,{direction:"row",spacing:1,children:[e.jsx(ee,{title:"Vizualizar etiquetas",children:e.jsx(ie,{color:"primary",onClick:()=>{C(s.original),J()},children:e.jsx(Ze,{})})}),e.jsx(ee,{title:"Editar",children:e.jsx(ie,{color:"primary",onClick:()=>{C(s.original),U()},children:e.jsx(sr,{})})}),e.jsx(ee,{title:"Excluir",children:e.jsx(ie,{color:"error",onClick:()=>{w(s.original.id),_(!0),P(s.original.nome_item)},children:e.jsx(ar,{})})})]})}],[t]);return e.jsxs(e.Fragment,{children:[A?e.jsxs(M,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",children:[e.jsx(ue,{}),e.jsx(z,{variant:"body2",color:"textSecondary",sx:{mt:2},children:"Carregando..."})]}):e.jsx(fr,{data:i,columns:u,modalToggler:()=>{o(!0),C(null),F()}}),e.jsx(mr,{id:b,title:b,open:v,handleClose:K,nome:l}),e.jsx(pr,{openModalCreate:n,modalToggler:F}),e.jsx(gr,{modalEdit:S,handleClose:D,data:f}),e.jsx(_r,{tagsInvetory:j,handleClose:L,data:f})]})}export{Fr as default};
